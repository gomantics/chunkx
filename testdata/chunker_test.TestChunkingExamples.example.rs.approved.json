{
  "file": "example.rs",
  "language": "rust",
  "chunks": [
    {
      "Content": "use std::collections::HashMap;\nuse std::sync::{Arc, Mutex};\nuse std::time::{Duration, Instant};\nuse tokio::time::sleep;\n\n/// Represents the result of a cache operation\n#[derive(Debug, Clone)]\npub enum CacheResult\u003cT\u003e {\n    Hit(T),\n    Miss,\n    Expired,\n}\n\n/// Entry in the cache with expiration tracking\n#[derive(Debug, Clone)]\nstruct CacheEntry\u003cT\u003e {\n    value: T,\n    inserted_at: Instant,\n    ttl: Duration,\n}",
      "StartLine": 1,
      "EndLine": 20,
      "StartByte": 0,
      "EndByte": 411,
      "NodeTypes": [
        "attribute",
        "attribute_item",
        "doc_comment",
        "enum",
        "enum_item",
        "enum_variant",
        "enum_variant_list",
        "field_declaration",
        "field_declaration_list",
        "field_identifier",
        "identifier",
        "line_comment",
        "ordered_field_declaration_list",
        "outer_doc_comment_marker",
        "pub",
        "scoped_identifier",
        "scoped_use_list",
        "struct",
        "struct_item",
        "token_tree",
        "type_identifier",
        "type_parameters",
        "use",
        "use_declaration",
        "use_list",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "impl\u003cT: Clone\u003e CacheEntry\u003cT\u003e {\n    fn new(value: T, ttl: Duration) -\u003e Self {\n        Self {\n            value,\n            inserted_at: Instant::now(),\n            ttl,\n        }\n    }\n\n    fn is_expired(\u0026self) -\u003e bool {\n        self.inserted_at.elapsed() \u003e self.ttl\n    }\n}\n\n/// Thread-safe in-memory cache with TTL support\n",
      "StartLine": 22,
      "EndLine": 37,
      "StartByte": 413,
      "EndByte": 738,
      "NodeTypes": [
        "arguments",
        "binary_expression",
        "block",
        "call_expression",
        "constrained_type_parameter",
        "declaration_list",
        "doc_comment",
        "field_expression",
        "field_identifier",
        "field_initializer",
        "field_initializer_list",
        "fn",
        "function_item",
        "generic_type",
        "identifier",
        "impl",
        "impl_item",
        "line_comment",
        "outer_doc_comment_marker",
        "parameter",
        "parameters",
        "primitive_type",
        "scoped_identifier",
        "self",
        "self_parameter",
        "shorthand_field_initializer",
        "struct_expression",
        "trait_bounds",
        "type_arguments",
        "type_identifier",
        "type_parameters"
      ],
      "Language": "rust"
    },
    {
      "Content": "pub struct Cache\u003cK, V\u003e\nwhere\n    K: Eq + std::hash::Hash + Clone,\n    V: Clone,\n{\n    store: Arc\u003cMutex\u003cHashMap\u003cK, CacheEntry\u003cV\u003e\u003e\u003e\u003e,\n    default_ttl: Duration,\n    max_size: usize,\n    stats: Arc\u003cMutex\u003cCacheStats\u003e\u003e,\n}\n\n/// Statistics for cache operations\n#[derive(Debug, Default, Clone)]\npub struct CacheStats {\n    hits: u64,\n    misses: u64,\n    evictions: u64,\n    expirations: u64,\n}",
      "StartLine": 37,
      "EndLine": 55,
      "StartByte": 738,
      "EndByte": 1124,
      "NodeTypes": [
        "attribute",
        "attribute_item",
        "doc_comment",
        "field_declaration",
        "field_declaration_list",
        "field_identifier",
        "generic_type",
        "identifier",
        "line_comment",
        "outer_doc_comment_marker",
        "primitive_type",
        "pub",
        "scoped_identifier",
        "scoped_type_identifier",
        "struct",
        "struct_item",
        "token_tree",
        "trait_bounds",
        "type_arguments",
        "type_identifier",
        "type_parameters",
        "visibility_modifier",
        "where",
        "where_clause",
        "where_predicate"
      ],
      "Language": "rust"
    },
    {
      "Content": "impl\u003cK, V\u003e Cache\u003cK, V\u003e\nwhere\n    K: Eq + std::hash::Hash + Clone,\n    V: Clone,",
      "StartLine": 57,
      "EndLine": 60,
      "StartByte": 1126,
      "EndByte": 1205,
      "NodeTypes": [
        "generic_type",
        "identifier",
        "impl",
        "scoped_identifier",
        "scoped_type_identifier",
        "trait_bounds",
        "type_arguments",
        "type_identifier",
        "type_parameters",
        "where",
        "where_clause",
        "where_predicate"
      ],
      "Language": "rust"
    },
    {
      "Content": "{\n    /// Create a new cache with default TTL and maximum size\n    pub fn new(default_ttl: Duration, max_size: usize) -\u003e Self {\n        Self {\n            store: Arc::new(Mutex::new(HashMap::new())),\n            default_ttl,\n            max_size,\n            stats: Arc::new(Mutex::new(CacheStats::default())),\n        }\n    }\n\n    /// Insert a value into the cache with default TTL\n",
      "StartLine": 61,
      "EndLine": 73,
      "StartByte": 1206,
      "EndByte": 1589,
      "NodeTypes": [
        "arguments",
        "block",
        "call_expression",
        "doc_comment",
        "field_identifier",
        "field_initializer",
        "field_initializer_list",
        "fn",
        "function_item",
        "identifier",
        "line_comment",
        "outer_doc_comment_marker",
        "parameter",
        "parameters",
        "primitive_type",
        "pub",
        "scoped_identifier",
        "shorthand_field_initializer",
        "struct_expression",
        "type_identifier",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "pub fn insert(\u0026self, key: K, value: V) {\n        self.insert_with_ttl(key, value, self.default_ttl);\n    }\n\n    /// Insert a value with custom TTL\n",
      "StartLine": 73,
      "EndLine": 78,
      "StartByte": 1593,
      "EndByte": 1740,
      "NodeTypes": [
        "arguments",
        "block",
        "call_expression",
        "doc_comment",
        "expression_statement",
        "field_expression",
        "field_identifier",
        "fn",
        "function_item",
        "identifier",
        "line_comment",
        "outer_doc_comment_marker",
        "parameter",
        "parameters",
        "pub",
        "self",
        "self_parameter",
        "type_identifier",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "pub fn insert_with_ttl(\u0026self, key: K, value: V, ttl: Duration) {\n        let mut store = self.store.lock().unwrap();\n        \n        // Evict oldest entry if at capacity\n        if store.len() \u003e= self.max_size \u0026\u0026 !store.contains_key(\u0026key) {\n            if let Some(oldest_key) = store.keys().next().cloned() {\n                store.remove(\u0026oldest_key);\n                let mut stats = self.stats.lock().unwrap();\n                stats.evictions += 1;\n            }\n        }\n\n        store.insert(key, CacheEntry::new(value, ttl));\n    }",
      "StartLine": 78,
      "EndLine": 91,
      "StartByte": 1744,
      "EndByte": 2282,
      "NodeTypes": [
        "arguments",
        "binary_expression",
        "block",
        "call_expression",
        "compound_assignment_expr",
        "expression_statement",
        "field_expression",
        "field_identifier",
        "fn",
        "function_item",
        "identifier",
        "if",
        "if_expression",
        "integer_literal",
        "let",
        "let_condition",
        "let_declaration",
        "line_comment",
        "mutable_specifier",
        "parameter",
        "parameters",
        "pub",
        "reference_expression",
        "scoped_identifier",
        "self",
        "self_parameter",
        "tuple_struct_pattern",
        "type_identifier",
        "unary_expression",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "/// Get a value from the cache\n",
      "StartLine": 93,
      "EndLine": 94,
      "StartByte": 2288,
      "EndByte": 2319,
      "NodeTypes": [
        "doc_comment",
        "line_comment",
        "outer_doc_comment_marker"
      ],
      "Language": "rust"
    },
    {
      "Content": "pub fn get(\u0026self, key: \u0026K) -\u003e CacheResult\u003cV\u003e",
      "StartLine": 94,
      "EndLine": 94,
      "StartByte": 2323,
      "EndByte": 2367,
      "NodeTypes": [
        "fn",
        "generic_type",
        "identifier",
        "parameter",
        "parameters",
        "pub",
        "reference_type",
        "self",
        "self_parameter",
        "type_arguments",
        "type_identifier",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "{\n        let mut store = self.store.lock().unwrap();\n        let mut stats = self.stats.lock().unwrap();\n\n        match store.get(key) {\n            Some(entry) =\u003e {\n                if entry.is_expired() {\n                    store.remove(key);\n                    stats.expirations += 1;\n                    stats.misses += 1;\n                    CacheResult::Expired\n                } else {\n                    stats.hits += 1;\n                    CacheResult::Hit(entry.value.clone())\n                }\n            }\n            None =\u003e {\n                stats.misses += 1;\n                CacheResult::Miss\n            }\n        }\n    }",
      "StartLine": 94,
      "EndLine": 115,
      "StartByte": 2368,
      "EndByte": 3010,
      "NodeTypes": [
        "arguments",
        "block",
        "call_expression",
        "compound_assignment_expr",
        "else",
        "else_clause",
        "expression_statement",
        "field_expression",
        "field_identifier",
        "identifier",
        "if",
        "if_expression",
        "integer_literal",
        "let",
        "let_declaration",
        "match",
        "match_arm",
        "match_block",
        "match_expression",
        "match_pattern",
        "mutable_specifier",
        "scoped_identifier",
        "self",
        "tuple_struct_pattern"
      ],
      "Language": "rust"
    },
    {
      "Content": "/// Remove a value from the cache\n    pub fn remove(\u0026self, key: \u0026K) -\u003e Option\u003cV\u003e {\n        let mut store = self.store.lock().unwrap();\n        store.remove(key).map(|entry| entry.value)\n    }\n\n    /// Clear all entries from the cache\n    pub fn clear(\u0026self) {\n        let mut store = self.store.lock().unwrap();\n        store.clear();\n    }\n\n    /// Get current cache size\n",
      "StartLine": 117,
      "EndLine": 130,
      "StartByte": 3016,
      "EndByte": 3389,
      "NodeTypes": [
        "arguments",
        "block",
        "call_expression",
        "closure_expression",
        "closure_parameters",
        "doc_comment",
        "expression_statement",
        "field_expression",
        "field_identifier",
        "fn",
        "function_item",
        "generic_type",
        "identifier",
        "let",
        "let_declaration",
        "line_comment",
        "mutable_specifier",
        "outer_doc_comment_marker",
        "parameter",
        "parameters",
        "pub",
        "reference_type",
        "self",
        "self_parameter",
        "type_arguments",
        "type_identifier",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "pub fn size(\u0026self) -\u003e usize {\n        let store = self.store.lock().unwrap();\n        store.len()\n    }\n\n    /// Get cache statistics\n    pub fn stats(\u0026self) -\u003e CacheStats {\n        let stats = self.stats.lock().unwrap();\n        stats.clone()\n    }\n\n    /// Background task to clean up expired entries\n",
      "StartLine": 130,
      "EndLine": 142,
      "StartByte": 3393,
      "EndByte": 3696,
      "NodeTypes": [
        "arguments",
        "block",
        "call_expression",
        "doc_comment",
        "field_expression",
        "field_identifier",
        "fn",
        "function_item",
        "identifier",
        "let",
        "let_declaration",
        "line_comment",
        "outer_doc_comment_marker",
        "parameters",
        "primitive_type",
        "pub",
        "self",
        "self_parameter",
        "type_identifier",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "pub async fn cleanup_expired(\u0026self) {\n        loop {\n            sleep(Duration::from_secs(60)).await;\n            \n            let mut store = self.store.lock().unwrap();\n            let mut stats = self.stats.lock().unwrap();\n            \n            let expired_keys: Vec\u003cK\u003e = store\n                .iter()\n                .filter(|(_, entry)| entry.is_expired())\n                .map(|(key, _)| key.clone())\n                .collect();\n\n            for key in expired_keys {\n                store.remove(\u0026key);\n                stats.expirations += 1;\n            }\n        }\n    }\n}",
      "StartLine": 142,
      "EndLine": 161,
      "StartByte": 3700,
      "EndByte": 4286,
      "NodeTypes": [
        "_",
        "arguments",
        "async",
        "await",
        "await_expression",
        "block",
        "call_expression",
        "closure_expression",
        "closure_parameters",
        "compound_assignment_expr",
        "expression_statement",
        "field_expression",
        "field_identifier",
        "fn",
        "for",
        "for_expression",
        "function_item",
        "function_modifiers",
        "generic_type",
        "identifier",
        "in",
        "integer_literal",
        "let",
        "let_declaration",
        "loop",
        "loop_expression",
        "mutable_specifier",
        "parameters",
        "pub",
        "reference_expression",
        "scoped_identifier",
        "self",
        "self_parameter",
        "tuple_pattern",
        "type_arguments",
        "type_identifier",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "impl CacheStats {\n    pub fn hit_rate(\u0026self) -\u003e f64 {\n        let total = self.hits + self.misses;\n        if total == 0 {\n            0.0\n        } else {\n            self.hits as f64 / total as f64\n        }\n    }\n}\n\n#[cfg(test)]",
      "StartLine": 163,
      "EndLine": 174,
      "StartByte": 4288,
      "EndByte": 4519,
      "NodeTypes": [
        "as",
        "attribute",
        "attribute_item",
        "binary_expression",
        "block",
        "declaration_list",
        "else",
        "else_clause",
        "expression_statement",
        "field_expression",
        "field_identifier",
        "float_literal",
        "fn",
        "function_item",
        "identifier",
        "if",
        "if_expression",
        "impl",
        "impl_item",
        "integer_literal",
        "let",
        "let_declaration",
        "parameters",
        "primitive_type",
        "pub",
        "self",
        "self_parameter",
        "token_tree",
        "type_cast_expression",
        "type_identifier",
        "visibility_modifier"
      ],
      "Language": "rust"
    },
    {
      "Content": "mod tests {\n    use super::*;\n\n    #[test]\n    fn test_cache_insert_and_get() {\n        let cache = Cache::new(Duration::from_secs(60), 100);\n        cache.insert(\"key1\", \"value1\");\n        \n        match cache.get(\u0026\"key1\") {\n            CacheResult::Hit(val) =\u003e assert_eq!(val, \"value1\"),\n            _ =\u003e panic!(\"Expected cache hit\"),\n        }\n    }\n}",
      "StartLine": 175,
      "EndLine": 188,
      "StartByte": 4520,
      "EndByte": 4874,
      "NodeTypes": [
        "_",
        "arguments",
        "attribute",
        "attribute_item",
        "block",
        "call_expression",
        "declaration_list",
        "expression_statement",
        "field_expression",
        "field_identifier",
        "fn",
        "function_item",
        "identifier",
        "integer_literal",
        "let",
        "let_declaration",
        "macro_invocation",
        "match",
        "match_arm",
        "match_block",
        "match_expression",
        "match_pattern",
        "mod",
        "mod_item",
        "parameters",
        "reference_expression",
        "scoped_identifier",
        "string_content",
        "string_literal",
        "super",
        "token_tree",
        "tuple_struct_pattern",
        "use",
        "use_declaration",
        "use_wildcard"
      ],
      "Language": "rust"
    }
  ]
}