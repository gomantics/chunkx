{
  "file": "example.py",
  "language": "python",
  "chunks": [
    {
      "Content": "import asyncio\nimport aiohttp\nfrom typing import List, Dict, Any, Optional\nfrom dataclasses import dataclass\nfrom datetime import datetime\n\n\n@dataclass\nclass APIResponse:\n    \"\"\"Represents an API response with metadata\"\"\"\n    url: str\n    status: int\n    data: Optional[Dict[str, Any]] = None\n    error: Optional[str] = None\n    timestamp: float = 0.0",
      "StartLine": 1,
      "EndLine": 15,
      "StartByte": 0,
      "EndByte": 351,
      "NodeTypes": [
        "assignment",
        "block",
        "class",
        "class_definition",
        "decorated_definition",
        "decorator",
        "dotted_name",
        "expression_statement",
        "float",
        "from",
        "generic_type",
        "identifier",
        "import",
        "import_from_statement",
        "import_statement",
        "none",
        "string",
        "string_content",
        "string_end",
        "string_start",
        "type",
        "type_parameter"
      ],
      "Language": "python"
    },
    {
      "Content": "class AsyncAPIClient:",
      "StartLine": 18,
      "EndLine": 18,
      "StartByte": 354,
      "EndByte": 375,
      "NodeTypes": [
        "class",
        "identifier"
      ],
      "Language": "python"
    },
    {
      "Content": "\"\"\"Asynchronous API client with rate limiting and retry logic\"\"\"\n    \n    def __init__(self, base_url: str, max_concurrent: int = 10, timeout: int = 30):\n        self.base_url = base_url\n        self.max_concurrent = max_concurrent\n        self.timeout = aiohttp.ClientTimeout(total=timeout)\n        self.session: Optional[aiohttp.ClientSession] = None\n        self.results: List[APIResponse] = []\n    \n    async def __aenter__(self):\n        \"\"\"Context manager entry\"\"\"\n        self.session = aiohttp.ClientSession(timeout=self.timeout)\n        return self",
      "StartLine": 19,
      "EndLine": 31,
      "StartByte": 380,
      "EndByte": 937,
      "NodeTypes": [
        "argument_list",
        "assignment",
        "async",
        "attribute",
        "block",
        "call",
        "def",
        "expression_statement",
        "function_definition",
        "generic_type",
        "identifier",
        "integer",
        "keyword_argument",
        "list",
        "none",
        "parameters",
        "return",
        "return_statement",
        "string",
        "string_content",
        "string_end",
        "string_start",
        "type",
        "type_parameter",
        "typed_default_parameter",
        "typed_parameter"
      ],
      "Language": "python"
    },
    {
      "Content": "async def __aexit__(self, exc_type, exc_val, exc_tb):\n        \"\"\"Context manager exit\"\"\"\n        if self.session:\n            await self.session.close()",
      "StartLine": 33,
      "EndLine": 36,
      "StartByte": 947,
      "EndByte": 1099,
      "NodeTypes": [
        "argument_list",
        "async",
        "attribute",
        "await",
        "block",
        "call",
        "def",
        "expression_statement",
        "function_definition",
        "identifier",
        "if",
        "if_statement",
        "parameters",
        "string",
        "string_content",
        "string_end",
        "string_start"
      ],
      "Language": "python"
    },
    {
      "Content": "async def fetch_endpoint(self, endpoint: str, retries: int = 3) -\u003e APIResponse:",
      "StartLine": 38,
      "EndLine": 38,
      "StartByte": 1109,
      "EndByte": 1188,
      "NodeTypes": [
        "async",
        "def",
        "identifier",
        "integer",
        "parameters",
        "type",
        "typed_default_parameter",
        "typed_parameter"
      ],
      "Language": "python"
    },
    {
      "Content": "\"\"\"Fetch data from a single endpoint with retry logic\"\"\"\n        url = f\"{self.base_url}/{endpoint.lstrip('/')}\"",
      "StartLine": 39,
      "EndLine": 40,
      "StartByte": 1197,
      "EndByte": 1309,
      "NodeTypes": [
        "argument_list",
        "assignment",
        "attribute",
        "call",
        "expression_statement",
        "identifier",
        "interpolation",
        "string",
        "string_content",
        "string_end",
        "string_start"
      ],
      "Language": "python"
    },
    {
      "Content": "for attempt in range(retries):\n            try:\n                async with self.session.get(url) as response:\n                    data = await response.json()\n                    return APIResponse(\n                        url=url,\n                        status=response.status,\n                        data=data,\n                        timestamp=datetime.now().timestamp()\n                    )\n            except aiohttp.ClientError as e:\n                if attempt == retries - 1:\n                    return APIResponse(\n                        url=url,\n                        status=0,\n                        error=str(e),\n                        timestamp=datetime.now().timestamp()\n                    )\n                await asyncio.sleep(2 ** attempt)  # Exponential backoff",
      "StartLine": 42,
      "EndLine": 60,
      "StartByte": 1327,
      "EndByte": 2113,
      "NodeTypes": [
        "argument_list",
        "as",
        "as_pattern",
        "as_pattern_target",
        "assignment",
        "async",
        "attribute",
        "await",
        "binary_operator",
        "block",
        "call",
        "comment",
        "comparison_operator",
        "except",
        "except_clause",
        "expression_statement",
        "for",
        "for_statement",
        "identifier",
        "if",
        "if_statement",
        "in",
        "integer",
        "keyword_argument",
        "return",
        "return_statement",
        "try",
        "try_statement",
        "with",
        "with_clause",
        "with_item",
        "with_statement"
      ],
      "Language": "python"
    },
    {
      "Content": "return APIResponse(url=url, status=0, error=\"Max retries exceeded\")",
      "StartLine": 62,
      "EndLine": 62,
      "StartByte": 2131,
      "EndByte": 2198,
      "NodeTypes": [
        "argument_list",
        "call",
        "identifier",
        "integer",
        "keyword_argument",
        "return",
        "return_statement",
        "string",
        "string_content",
        "string_end",
        "string_start"
      ],
      "Language": "python"
    },
    {
      "Content": "async def fetch_multiple(self, endpoints: List[str]) -\u003e List[APIResponse]:\n        \"\"\"Fetch data from multiple endpoints concurrently\"\"\"\n        semaphore = asyncio.Semaphore(self.max_concurrent)\n        \n        async def fetch_with_semaphore(endpoint: str) -\u003e APIResponse:\n            async with semaphore:\n                return await self.fetch_endpoint(endpoint)\n        \n        tasks = [fetch_with_semaphore(endpoint) for endpoint in endpoints]\n        self.results = await asyncio.gather(*tasks)\n        return self.results",
      "StartLine": 64,
      "EndLine": 74,
      "StartByte": 2208,
      "EndByte": 2739,
      "NodeTypes": [
        "argument_list",
        "assignment",
        "async",
        "attribute",
        "await",
        "block",
        "call",
        "def",
        "expression_statement",
        "for",
        "for_in_clause",
        "function_definition",
        "generic_type",
        "identifier",
        "in",
        "list_comprehension",
        "list_splat",
        "parameters",
        "return",
        "return_statement",
        "string",
        "string_content",
        "string_end",
        "string_start",
        "type",
        "type_parameter",
        "typed_parameter",
        "with",
        "with_clause",
        "with_item",
        "with_statement"
      ],
      "Language": "python"
    },
    {
      "Content": "def get_successful_results(self) -\u003e List[APIResponse]:\n        \"\"\"Filter and return only successful responses\"\"\"\n        return [r for r in self.results if r.status == 200 and r.data is not None]\n    \n    def get_failed_results(self) -\u003e List[APIResponse]:\n        \"\"\"Filter and return only failed responses\"\"\"\n        return [r for r in self.results if r.error is not None or r.status != 200]",
      "StartLine": 76,
      "EndLine": 82,
      "StartByte": 2749,
      "EndByte": 3141,
      "NodeTypes": [
        "and",
        "attribute",
        "block",
        "boolean_operator",
        "comparison_operator",
        "def",
        "expression_statement",
        "for",
        "for_in_clause",
        "function_definition",
        "generic_type",
        "identifier",
        "if",
        "if_clause",
        "in",
        "integer",
        "is",
        "is not",
        "list_comprehension",
        "none",
        "not",
        "or",
        "parameters",
        "return",
        "return_statement",
        "string",
        "string_content",
        "string_end",
        "string_start",
        "type",
        "type_parameter"
      ],
      "Language": "python"
    },
    {
      "Content": "async def main():\n    \"\"\"Example usage of AsyncAPIClient\"\"\"\n    endpoints = [\n        \"/users\",\n        \"/posts\",\n        \"/comments\",\n        \"/albums\",\n        \"/photos\"\n    ]\n    \n    async with AsyncAPIClient(\"https://jsonplaceholder.typicode.com\", max_concurrent=3) as client:\n        results = await client.fetch_multiple(endpoints)\n        \n        successful = client.get_successful_results()\n        failed = client.get_failed_results()\n        \n        print(f\"Successful requests: {len(successful)}\")\n        print(f\"Failed requests: {len(failed)}\")\n        \n        for result in failed:\n            print(f\"Error fetching {result.url}: {result.error}\")",
      "StartLine": 85,
      "EndLine": 105,
      "StartByte": 3144,
      "EndByte": 3809,
      "NodeTypes": [
        "argument_list",
        "as",
        "as_pattern",
        "as_pattern_target",
        "assignment",
        "async",
        "attribute",
        "await",
        "block",
        "call",
        "def",
        "expression_statement",
        "for",
        "for_statement",
        "function_definition",
        "identifier",
        "in",
        "integer",
        "interpolation",
        "keyword_argument",
        "list",
        "parameters",
        "string",
        "string_content",
        "string_end",
        "string_start",
        "with",
        "with_clause",
        "with_item",
        "with_statement"
      ],
      "Language": "python"
    },
    {
      "Content": "if __name__ == \"__main__\":\n    asyncio.run(main())",
      "StartLine": 108,
      "EndLine": 109,
      "StartByte": 3812,
      "EndByte": 3862,
      "NodeTypes": [
        "argument_list",
        "attribute",
        "block",
        "call",
        "comparison_operator",
        "expression_statement",
        "identifier",
        "if",
        "if_statement",
        "string",
        "string_content",
        "string_end",
        "string_start"
      ],
      "Language": "python"
    }
  ]
}